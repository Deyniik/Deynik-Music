<div style="padding: 0; width: 100%;">
    <!-- ЗАГОЛОВОК -->
    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 30px;">
        <div>
            <h1 style="font-size: 32px; font-weight: 800; margin-bottom: 8px;">Видеоклипы</h1>
            <p style="color: #7a7a7a; font-size: 15px;">Смотри лучшие клипы в высоком качестве</p>
        </div>
        <div style="display: flex; gap: 12px;">
            <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="document.getElementById('video-grid').classList.toggle('compact-view')">
                <i data-lucide="layout-grid" size="20" color="white"></i>
            </div>
            <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="window.sortVideos()">
                <i data-lucide="arrow-up-down" size="20" color="white"></i>
            </div>
        </div>
    </div>

    <!-- ФИЛЬТРЫ ПО ЖАНРАМ -->
    <div style="display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap;">
        <button class="tab active" onclick="window.filterVideos('all', this)" style="background: white; color: black;">Все</button>
        <button class="tab" onclick="window.filterVideos('pop', this)">Pop</button>
    </div>

    <!-- ГРИД С ВИДЕО -->
    <div id="video-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px;">
        <!-- Taylor Swift - 22 -->
        <div class="video-card" data-category="pop" onclick="window.playVideo('https://s3.k-connect.ru/static/uploads/post/11561/FvHevpyAMu_Taylor_Swift_-_22_-_Taylor_Swift_1080p_h264.mp4', '22', 'Taylor Swift', '3:52', 'https://s3.k-connect.ru/static/uploads/comments/11561/sddefault.jpg')">
            <div class="video-thumbnail">
                <img src="https://s3.k-connect.ru/static/uploads/comments/11561/sddefault.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:12px;">
                <div class="video-duration">3:52</div>
                <div class="video-play-overlay">
                    <i data-lucide="play" size="40" color="white" fill="white"></i>
                </div>
            </div>
            <div style="display:flex; gap:12px; margin-top:12px;">
                <img src="https://s3.k-connect.ru/static/uploads/post/11563/ZiWYMMBLcz_channels4_profile%20(1).webp" style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                <div>
                    <b style="font-size:15px;">22</b>
                    <br>
                    <small style="color:#7a7a7a;">Taylor Swift</small>
                </div>
            </div>
        </div>

        <!-- Taylor Swift - Opalite -->
        <div class="video-card" data-category="pop" onclick="window.playVideo('https://s3.k-connect.ru/static/uploads/post/11560/UipqebVHl8_Taylor_Swift_-_Opalite_Official_Music_Video_-_Taylor_Swift_1080p_h264.mp4', 'Opalite', 'Taylor Swift', '4:15', 'https://s3.k-connect.ru/static/uploads/comments/11560/maxresdefault.jpg')">
            <div class="video-thumbnail">
                <img src="https://s3.k-connect.ru/static/uploads/comments/11560/maxresdefault.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:12px;">
                <div class="video-duration">4:15</div>
                <div class="video-play-overlay">
                    <i data-lucide="play" size="40" color="white" fill="white"></i>
                </div>
            </div>
            <div style="display:flex; gap:12px; margin-top:12px;">
                <img src="https://s3.k-connect.ru/static/uploads/post/11563/ZiWYMMBLcz_channels4_profile%20(1).webp" style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                <div>
                    <b style="font-size:15px;">Opalite</b>
                    <br>
                    <small style="color:#7a7a7a;">Taylor Swift</small>
                </div>
            </div>
        </div>

        <!-- Lady Gaga - Abracadabra -->
        <div class="video-card" data-category="pop" onclick="window.playVideo('https://s3.k-connect.ru/static/uploads/post/11559/ABInwxgnTA_Lady_Gaga_-_Abracadabra_Official_Music_Video_-_LadyGagaVEVO_1080p_h264_2.mp4', 'Abracadabra', 'Lady Gaga', '3:43', 'https://s3.k-connect.ru/static/uploads/comments/11559/sddefault.jpg')">
            <div class="video-thumbnail">
                <img src="https://s3.k-connect.ru/static/uploads/comments/11559/sddefault.jpg" style="width:100%; height:100%; object-fit:cover; border-radius:12px;">
                <div class="video-duration">3:43</div>
                <div class="video-play-overlay">
                    <i data-lucide="play" size="40" color="white" fill="white"></i>
                </div>
            </div>
            <div style="display:flex; gap:12px; margin-top:12px;">
                <img src="https://s3.k-connect.ru/static/music/1475/5955/1770656744_cover.jpeg" style="width:40px; height:40px; border-radius:50%; object-fit:cover;">
                <div>
                    <b style="font-size:15px;">Abracadabra</b>
                    <br>
                    <small style="color:#7a7a7a;">Lady Gaga</small>
                </div>
            </div>
        </div>
    </div>

    <!-- ВИДЕО ПЛЕЕР -->
    <div id="video-player-container" style="display: none;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <div style="display: flex; align-items: center; gap: 16px;">
                <div class="p-btn" style="width: 45px; height: 45px; background: #CC6B26;" onclick="window.closeVideoPlayer()">
                    <i data-lucide="x" size="20" color="white"></i>
                </div>
                <div>
                    <h2 id="video-player-title" style="font-size: 22px; font-weight: 700;">Abracadabra</h2>
                    <p id="video-player-artist" style="color: #7a7a7a;">Lady Gaga</p>
                </div>
            </div>
            <div style="display: flex; gap: 12px;">
                <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="window.likeCurrentVideo()">
                    <i id="video-like-icon" data-lucide="heart" size="20" color="white" fill="none"></i>
                </div>
                <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="window.shareVideo()">
                    <i data-lucide="share-2" size="20" color="white"></i>
                </div>
            </div>
        </div>
        
        <div style="position: relative; width: 100%; background: #000; border-radius: 12px; overflow: hidden;">
            <video id="video-player" controls style="width: 100%; display: block;" src="">
                Ваш браузер не поддерживает видео тег.
            </video>
        </div>
        
        <div style="display: flex; align-items: center; gap: 20px; margin-top: 20px;">
            <div style="display: flex; align-items: center; gap: 16px;">
                <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="window.playPreviousVideo()">
                    <i data-lucide="skip-back" size="20" color="white"></i>
                </div>
                <div class="p-btn" style="width: 50px; height: 50px; background: white; color: black;" onclick="window.toggleVideoPlay()">
                    <i id="video-play-pause-icon" data-lucide="pause" size="24" fill="black" color="black"></i>
                </div>
                <div class="p-btn" style="width: 45px; height: 45px; background: #1a1a1a;" onclick="window.playNextVideo()">
                    <i data-lucide="skip-forward" size="20" color="white"></i>
                </div>
            </div>
            <div style="flex: 1; height: 5px; background: #3e3e3e; border-radius: 3px; position: relative;">
                <div id="video-progress" style="width: 0%; height: 100%; background: #CC6B26; border-radius: 3px;"></div>
            </div>
            <span id="video-time" style="color: #7a7a7a; font-size: 13px;">0:00 / 0:00</span>
        </div>
    </div>
</div>

<script>
    (function() {
        'use strict';

        // ========== СОСТОЯНИЕ ВИДЕО ==========
        window.videoPlaylist = [];
        window.currentVideoIndex = -1;
        window.isVideoPlaying = false;
        window.videoLikes = {};

        // ========== ВОСПРОИЗВЕДЕНИЕ ВИДЕО ==========
        window.playVideo = function(videoUrl, title, artist, duration, coverArt) {
            const container = document.getElementById('video-player-container');
            const video = document.getElementById('video-player');
            const titleEl = document.getElementById('video-player-title');
            const artistEl = document.getElementById('video-player-artist');
            
            if (container && video) {
                container.style.display = 'block';
                video.src = videoUrl;
                video.play();
                if (titleEl) titleEl.textContent = title;
                if (artistEl) artistEl.textContent = artist;
                
                window.currentVideoTitle = title;
                window.currentVideoArtist = artist;
                window.currentVideoUrl = videoUrl;
                window.currentVideoDuration = duration;
                window.currentVideoCover = coverArt;
                
                window.isVideoPlaying = true;
                
                // Обновляем иконку
                const playIcon = document.getElementById('video-play-pause-icon');
                if (playIcon) {
                    playIcon.setAttribute('data-lucide', 'pause');
                }
                
                // Обновляем иконку лайка
                const likeIcon = document.getElementById('video-like-icon');
                if (likeIcon) {
                    const isLiked = window.videoLikes?.[videoUrl] || false;
                    likeIcon.setAttribute('fill', isLiked ? '#CC6B26' : 'none');
                    likeIcon.setAttribute('color', isLiked ? '#CC6B26' : 'white');
                }
                
                // Плавный скролл
                setTimeout(() => {
                    container.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
                
                lucide.createIcons();
                
                // Обновляем время
                video.ontimeupdate = function() {
                    const progress = document.getElementById('video-progress');
                    const timeEl = document.getElementById('video-time');
                    if (progress && timeEl) {
                        const pct = (video.currentTime / video.duration) * 100 || 0;
                        progress.style.width = pct + '%';
                        timeEl.textContent = formatTime(video.currentTime) + ' / ' + formatTime(video.duration);
                    }
                };
            }
        };

        // ========== ФОРМАТ ВРЕМЕНИ ==========
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return mins + ':' + (secs < 10 ? '0' : '') + secs;
        }

        // ========== ЗАКРЫТЬ ПЛЕЕР ==========
        window.closeVideoPlayer = function() {
            const container = document.getElementById('video-player-container');
            const video = document.getElementById('video-player');
            
            if (container && video) {
                container.style.display = 'none';
                video.pause();
                video.src = '';
                window.isVideoPlaying = false;
            }
        };

        // ========== ЛАЙК ДЛЯ ВИДЕО ==========
        window.likeCurrentVideo = function() {
            if (!window.currentVideoUrl) return;
            
            if (!window.videoLikes) window.videoLikes = {};
            window.videoLikes[window.currentVideoUrl] = !window.videoLikes[window.currentVideoUrl];
            
            const likeIcon = document.getElementById('video-like-icon');
            if (likeIcon) {
                if (window.videoLikes[window.currentVideoUrl]) {
                    likeIcon.setAttribute('fill', '#CC6B26');
                    likeIcon.setAttribute('color', '#CC6B26');
                } else {
                    likeIcon.setAttribute('fill', 'none');
                    likeIcon.setAttribute('color', 'white');
                }
                lucide.createIcons();
            }
        };

        // ========== ПОДЕЛИТЬСЯ ==========
        window.shareVideo = function() {
            if (!window.currentVideoUrl) return;
            
            navigator.clipboard.writeText(window.currentVideoUrl).then(() => {
                const btn = event.currentTarget;
                btn.style.animation = 'share-pop 0.4s ease';
                setTimeout(() => {
                    btn.style.animation = '';
                }, 400);
                
                const icon = btn.querySelector('i');
                icon.setAttribute('data-lucide', 'check');
                lucide.createIcons();
                
                setTimeout(() => {
                    icon.setAttribute('data-lucide', 'share-2');
                    lucide.createIcons();
                }, 1500);
            });
        };

        // ========== ФИЛЬТРАЦИЯ ВИДЕО ==========
        window.filterVideos = function(category, btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            
            const videos = document.querySelectorAll('.video-card');
            videos.forEach(video => {
                if (category === 'all') {
                    video.style.display = 'block';
                } else {
                    const videoCategory = video.getAttribute('data-category');
                    video.style.display = videoCategory === category ? 'block' : 'none';
                }
            });
            
            if (document.getElementById('video-grid').classList.contains('compact-view')) {
                videos.forEach(video => {
                    if (video.style.display === 'block') {
                        video.style.display = 'flex';
                    }
                });
            }
        };

        // ========== СОРТИРОВКА ==========
        window.sortVideos = function() {
            const grid = document.getElementById('video-grid');
            const videos = Array.from(document.querySelectorAll('.video-card'));
            
            videos.sort((a, b) => {
                const titleA = a.querySelector('b')?.textContent || '';
                const titleB = b.querySelector('b')?.textContent || '';
                return titleA.localeCompare(titleB);
            });
            
            grid.innerHTML = '';
            videos.forEach(video => grid.appendChild(video));
            lucide.createIcons();
        };

        // ========== НАВИГАЦИЯ ПО ВИДЕО ==========
        window.playNextVideo = function() {
            const videos = Array.from(document.querySelectorAll('.video-card'));
            const currentIndex = videos.findIndex(v => {
                const onclick = v.getAttribute('onclick') || '';
                return onclick.includes(window.currentVideoUrl || '');
            });
            
            if (currentIndex < videos.length - 1) {
                videos[currentIndex + 1].click();
            }
        };

        window.playPreviousVideo = function() {
            const videos = Array.from(document.querySelectorAll('.video-card'));
            const currentIndex = videos.findIndex(v => {
                const onclick = v.getAttribute('onclick') || '';
                return onclick.includes(window.currentVideoUrl || '');
            });
            
            if (currentIndex > 0) {
                videos[currentIndex - 1].click();
            }
        };

        window.toggleVideoPlay = function() {
            const video = document.getElementById('video-player');
            const icon = document.getElementById('video-play-pause-icon');
            
            if (video) {
                if (video.paused) {
                    video.play();
                    window.isVideoPlaying = true;
                    icon.setAttribute('data-lucide', 'pause');
                } else {
                    video.pause();
                    window.isVideoPlaying = false;
                    icon.setAttribute('data-lucide', 'play');
                }
                lucide.createIcons();
            }
        };

        // ========== ИНИЦИАЛИЗАЦИЯ ==========
        setTimeout(() => {
            // Собираем видео в плейлист
            const videoCards = document.querySelectorAll('.video-card');
            window.videoPlaylist = Array.from(videoCards).map((card, index) => {
                const titleEl = card.querySelector('b');
                const artistEl = card.querySelector('small');
                const durationEl = card.querySelector('.video-duration');
                const coverEl = card.querySelector('img:first-child');
                const avatarEl = card.querySelector('img:last-child');
                
                return {
                    id: index,
                    title: titleEl?.textContent || 'Без названия',
                    artist: artistEl?.textContent || 'Неизвестный исполнитель',
                    duration: durationEl?.textContent || '3:00',
                    thumbnail: coverEl?.src || '',
                    avatar: avatarEl?.src || '',
                    url: card.getAttribute('onclick')?.match(/'([^']+)'/)?.filter((m, i) => i === 1)?.[0] || ''
                };
            });
            
            lucide.createIcons();
        }, 100);
    })();
</script>
